

<div class="container px-5 px-sm-0">

  <div class="row">

<%= render 'public/posts/list',customer: @customer %>
<div class="col-md-8 offset-md-1">
<h3 class="mt-3">投稿の詳細</h3>

<p><%= @post.title %></p>

<div class="card">
  <div>
    <% if @post.images.attached? %>
      <% @post.images.each do |image| %>
        <%= image_tag image.variant(resize_to_limit: [300, 300]),class: "rounded" %>
      <% end %>
    <% end %>
  </div>
    <div class="card-body">
      <h5 class="card-title">Card title</h5>
      <p class="card-text">This card has supporting text below as a natural lead-in to additional content.</p>
      <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
    </div>
</div>

  <% if @post.images.attached? %>
    <% @post.images.each do |image| %>
      <%= image_tag image.variant(resize_to_limit: [300, 300]),class: "rounded" %>
    <% end %>
  <% end %>


<div>コメント件数：<%= @post.comments.count %></div>

  <!--いいね機能-->
  <% if @post.favorited_by?(current_customer) %>
    <p>
      <%= link_to post_favorites_path(@post), method: :delete do %>
        <i class="fas fa-heart" aria-hidden="true" style="color: red;"></i>
        <%= @post.favorites.count %>
      <% end %>
    </p>
    <% else %>
    <div>
      <%= link_to post_favorites_path(@post), method: :post do %>
        <i class="fas fa-heart" aria-hidden="true"></i>
        <%= @post.favorites.count %>
      <% end %>
    </div>
  <% end %>

<p><%= @post.body %></p>

<table class="table">
  <% @post.comments.each do |comment| %>
  <tr>
    <td>
      <%= link_to customer_path(@customer.id) do %>
      <%= image_tag comment.customer.get_profile_image(50,50), class: "rounded-circle" %><br />
      <%= comment.customer.full_name %>
      <% end %>
    </td>
    <td><%= comment.created_at.strftime('%Y/%m/%d') %></td>
    <td><%= comment.comment %></td>
    <td>
      <% if comment.customer == current_customer %>
      <%= link_to "コメント削除", post_comment_path(comment.post,comment), method: :delete, class: 'btn btn-danger rounded-pill' %>
      <% end %>
    </td>
    <% end %>
  </tr>
</table>

<div>
  <%= form_with model: [@post, @comment] do |f| %>
    <%= f.text_area :comment, rows: '5', placeholder: "コメントをここに", class: 'w-100' %>
    <%= f.submit "送信する" %>
  <% end %>
</div>
<div class="mt-3">
<% if @post.customer == current_customer %>
  <%= link_to "投稿を削除", post_path(@post.id), method: :delete, "data-confirm" => "本当に削除しますか?", class: "btn btn-sm btn-danger rounded-pill" %>
  <%= link_to "投稿を編集", edit_post_path, class: "btn btn-sm btn-success rounded-pill" %>
<% end %>
<%= link_to "会員ページに戻る", customer_path(@customer.id), class: "btn btn-sm btn-success rounded-pill" %>
</div>

  </div>
  </div>
  </div>